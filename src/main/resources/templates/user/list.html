<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>userList</title>
    <meta name="description" content=""/>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
    <link rel="stylesheet" th:href="@{/css/bootstrap/bootstrap.css}"/>
    <link rel="stylesheet" th:href="@{/css/selectize/selectize.css}"/>
    <link rel="stylesheet" th:href="@{/css/selectize/selectize.bootstrap3.css}"/>
    <link rel="stylesheet" th:href="@{/css/index.css}"/>
    <script th:src="@{/js/jquery/jquery-3.2.1.min.js}"></script>
    <script th:src="@{/js/bootstrap/bootstrap.min.js}"></script>
    <script th:src="@{/js/selectize/standalone/selectize.min.js}"></script>
</head>
<body class="container">

<!-- 引入header - 通过tag名称引用 -->
<header th:replace="common/header :: header"></header>
<!-- 当前位置 -->
<div class="current">用户列表</div>
<!-- 内容 -->
<div class="content">
    <table class="table table-hover">
        <thead>
        <tr>
            <th>#</th>
            <th>Login Name</th>
            <th>Phone</th>
            <th>Nick Name</th>
            <th>Email</th>
            <th>操作</th>
            <th></th>
            <th></th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${users}">
            <th scope="row" th:text="${user.id}"></th>
            <td th:text="${user.loginName}"></td>
            <td th:text="${user.phone}"></td>
            <td th:text="${user.nickName}"></td>
            <td th:text="${user.email}"></td>
            <td><a th:href="@{/user/toEdit(id=${user.id})}">编辑</a></td>
            <td><a th:href="@{/user/(id=${user.id})}">冻结</a></td>
            <td><a href="javascript:void(0);"
                   th:onclick="'showRoleModal(\''+${user.id}+'\',\''+${user.loginName}+'\')'">关联角色</a></td>
            <td><a th:href="@{/user/delete(id=${user.id})}">删除</a></td>
        </tr>
        </tbody>
    </table>

    <div class="row">
        <div class="col-sm-2 control-label">
            <a href="/toAdd" th:href="@{/user/toAdd}" class="btn btn-info">add</a>
        </div>
    </div>
</div>

<!-- 引入footer - 通过tag名称引用 -->
<!--<header th:replace="common/footer :: footer"></header>-->

<!-- 模态框（Modal） -->
<div class="modal fade" id="roleModal" tabindex="-1" role="dialog" aria-labelledby="roleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="roleModalLabel">
                    关联角色
                </h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal">
                    <input id="userId" type="hidden"/>
                    <div class="form-group">
                        <label for="userLoginName" class="col-sm-3 control-label">用户：</label>
                        <div class="col-sm-8">
                            <p id="userLoginName" class="form-control-static"></p>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="role" class="col-sm-3 control-label">选择角色：</label>
                        <div class="col-sm-8">
                            <select id="role" class="selectize-control" placeholder="选择一个...">
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                </button>
                <button type="button" class="btn btn-primary" onclick="associateRole()">
                    确认
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<script th:inline="javascript">
    $(function () {
        $("#roleModal").modal("hide");
    });

    /**
     * 激活selectize
     */
    $('#role').selectize({
        create: true
    });

    function showRoleModal(userId, userLoginName) {
        var roleSelect = $("#role")[0].selectize;
        roleSelect.addOption({id:1,label:"whatever"});
        roleSelect.addOption({id:2,label:"whatever2"});
        roleSelect.refreshOptions();
        roleSelect.addItem(1);

        $("#userId").val(userId);
        $("#userLoginName").text(userLoginName);
        $("#roleModal").modal("show");
    }

    function associateRole() {

    }

</script>

</body>
</html>